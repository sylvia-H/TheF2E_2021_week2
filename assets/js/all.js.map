{"version":3,"sources":["_bike.js","_lottieLogo.js","_route.js","_spot.js","_valid.js"],"names":["pos_lat","pos_lng","getCurrentPos","navigator","geolocation","getCurrentPosition","success","error","alert","code","PERMISSION_DENIED","console","log","POSITION_UNAVAILABLE","TIMEOUT","UNKNOWN_ERROR","pos","coords","latitude","longitude","bikeMap","setView","L","tileLayer","attribution","maxZoom","id","tileSize","zoomOffset","accessToken","addTo","posGPSIcon","divIcon","iconSize","html","marker","icon","gpsYoubike","lottie","loadAnimation","wrapper","lottie_GPS","animType","loop","autoplay","path","play","get_nearbyStation","sourceData","lat","lng","endpoint","axios","get","headers","getAuthorizationHeader","then","response","data","get_nearbyAvailability","err","newData","availableData","forEach","sourceItem","newItem","StationUID","StationName","StationAddress","StationPosition","push","set_lendMarkers","lendLayer","el","lendIcon","iconAnchor","popupAnchor","AvailableRentBikes","stationStatus","stationStatus_class","ServiceStatus","popUpContent","Zh_tw","AvailableReturnBikes","PositionLat","PositionLon","bindPopup","setPopupContent","returnLayer","set_returnMarkers","returnIcon","getCurrentPos_route","routeMap","cityRoute","get_cityRoute","city","str","RouteName","select_route","innerHTML","get_Route","route","routeLayer","removeLayer","routeInfoLayer","routeEndLayer","item","geo","Geometry","polyLine","geoData","routeInfo","wicket","Wkt","geojsonFeature","read","toJson","coordinates","pathData","map","reverse","pathStyle","Polyline","AntPath","fitBounds","getBounds","startIcon","iconUrl","endIcon","Direction","parseInt","CyclingLength","toFixed","RoadSectionStart","RoadSectionEnd","openPopup","length","getCurrentPos_spot","spotMap","AppID","AppKey","GMTString","Date","toGMTString","ShaObj","jsSHA","setHMACKey","update","HMAC","getHMAC","Authorization"],"mappings":"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","file":"all.js","sourcesContent":["// 全域變數\r\nlet pos_lat; // 緯度\r\nlet pos_lng; // 經度\r\n\r\n// markerCluster 合併標記點\r\n// let lendMarkers;\r\n// let returnMarkers;\r\n\r\n// 取得使用者目前所在位置、載入地圖圖資、標記當前位置\r\n// 判斷當前頁面導入適當功能\r\nfunction getCurrentPos(){\r\n  \r\n  // 先判斷使用者裝置是否有 navigator.geolocation 功能，並執行之\r\n  if(navigator.geolocation){\r\n      navigator.geolocation.getCurrentPosition(success, error);\r\n      // navigator.geolocation.watchPosition(success, error);\r\n    } else {\r\n      // 若出現錯誤，先自動將定位定在台北市中心\r\n      pos_lat = 25.04;\r\n      pos_lng = 121.54;\r\n      alert('您的裝置不支援地理位置功能');\r\n    }\r\n  \r\n  // fun：錯誤訊息處理\r\n  function error(error){\r\n    // 若出現錯誤，先自動將定位定在台北市中心\r\n    pos_lat = 25.04;\r\n    pos_lng = 121.54;\r\n    // 各種錯誤碼類型\r\n    switch(error.code)  {\r\n      case error.PERMISSION_DENIED:\r\n          console.log(\"User denied the request for Geolocation.\");\r\n          break;\r\n\r\n      case error.POSITION_UNAVAILABLE:\r\n          console.log(\"Location information is unavailable.\");\r\n          break;\r\n\r\n      case error.TIMEOUT:\r\n          console.log(\"The request to get user location timed out.\");\r\n          break;\r\n\r\n      case error.UNKNOWN_ERROR:\r\n          console.log(\"An unknown error occurred.\");\r\n          break;\r\n    }\r\n  }\r\n\r\n  // fun：成功執行\r\n  function success(pos){\r\n    // 獲取目前位置經緯度\r\n    pos_lat = pos.coords.latitude;\r\n    pos_lng = pos.coords.longitude;\r\n    console.log(pos.coords.latitude,pos.coords.longitude);\r\n\r\n    // 設定地圖：以當前座標為中心點\r\n    bikeMap.setView([pos_lat,pos_lng], 16);\r\n    // let bikeMap = L.map('map_show', {\r\n    //     center: [pos_lat,pos_lng],\r\n    //     zoom: 16\r\n    // })\r\n\r\n    // 載入圖磚\r\n    L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {\r\n        attribution: 'Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors, Imagery © <a href=\"https://www.mapbox.com/\">Mapbox</a>',\r\n        maxZoom: 19,\r\n        id: 'mapbox/streets-v11',\r\n        tileSize: 512,\r\n        zoomOffset: -1,\r\n        accessToken: 'pk.eyJ1Ijoic3lsdmlhaC10dyIsImEiOiJja3c2Nzl2eHUweXlmMnFtZTRjb2VjcDQxIn0.Gx5M_zr8rDs4T-jawF2UDQ'\r\n    }).addTo(bikeMap);\r\n\r\n    // 目前所在位置 GPS 圖示內容\r\n    let posGPSIcon = L.divIcon({\r\n        iconSize: [70,70],\r\n        html: `<div id=\"lottie_GPS\"></div>`\r\n    });\r\n\r\n    // 在地圖上標記所在位置 GPS 圖示\r\n    L.marker([pos_lat,pos_lng], {icon: posGPSIcon}).addTo(bikeMap);\r\n\r\n    // 顯示所在位置 GPS 圖示 lottie 動畫\r\n    const gpsYoubike = lottie.loadAnimation({\r\n    wrapper: lottie_GPS,\r\n    animType: 'svg',\r\n    loop: true,\r\n    autoplay: false,\r\n    path: './assets/images/youbike_GPS.json'\r\n    });\r\n    gpsYoubike.play();\r\n\r\n    // 取得附近站點資訊\r\n    get_nearbyStation(pos_lat,pos_lng);\r\n\r\n  }\r\n\r\n}\r\n\r\n// 取得站點資訊，並賦予到 sourceData\r\nlet sourceData = [];\r\nfunction get_nearbyStation(lat,lng){\r\n  const endpoint = `https://ptx.transportdata.tw/MOTC/v2/Bike/Station/NearBy?$spatialFilter=nearby(${lat},${lng},1000)&$format=JSON`;\r\n\r\n  axios.get(endpoint,\r\n    {\r\n      headers: getAuthorizationHeader()\r\n    })\r\n  .then(response => {\r\n    sourceData = response.data;\r\n    get_nearbyAvailability(lat,lng);\r\n  })\r\n  .catch(err => console.log(err));\r\n\r\n}\r\n\r\n// 取得站點進階資訊，並整合到 newData\r\n// 判斷當前的 isLend 變數值，呈現不同的 marker\r\nlet newData = [];\r\nfunction get_nearbyAvailability(lat,lng){\r\n  const endpoint = `https://ptx.transportdata.tw/MOTC/v2/Bike/Availability/NearBy?$spatialFilter=nearby(${lat},${lng},1000)&$format=JSON`;\r\n  axios.get(endpoint,\r\n    {\r\n      headers: getAuthorizationHeader()\r\n    })\r\n  .then(function (response) {\r\n    const availableData = response.data;\r\n    sourceData.forEach(sourceItem=>{\r\n      availableData.forEach(newItem=>{\r\n        if(sourceItem.StationUID === newItem.StationUID){\r\n          newItem.StationName = sourceItem.StationName;\r\n          newItem.StationAddress = sourceItem.StationAddress;\r\n          newItem.StationPosition = sourceItem.StationPosition;\r\n          newData.push(newItem);\r\n        }\r\n      });\r\n    });\r\n    set_lendMarkers();\r\n  })\r\n  .catch(err => console.log(err));\r\n}\r\n\r\n// 標記租車站點與數量（黃色）\r\nlet lendLayer = null;\r\nfunction set_lendMarkers(){\r\n  // lendMarkers = new L.MarkerClusterGroup().addTo(bikeMap);\r\n  newData.forEach(el=>{\r\n    // 站點圖示\r\n    let lendIcon = L.divIcon({\r\n      iconSize: [0,0],\r\n      iconAnchor: [22, 94],\r\n      popupAnchor: [-3, -76],\r\n      html: `\r\n      <div class=\"lendIcon\">\r\n        <img src=\"./assets/images/icons/stationMark_yellow.svg\"/>\r\n        <div class=\"bikeNum\">\r\n          <span>${el.AvailableRentBikes}</span>\r\n        </div>\r\n      </div`\r\n    });\r\n\r\n    // 站點營運狀態判斷\r\n    let stationStatus;\r\n    let stationStatus_class;\r\n    switch (el.ServiceStatus) {\r\n      // [0:'停止營運',1:'正常營運',2:'暫停營運'] \r\n      case 0:\r\n        stationStatus = '停止營運';\r\n        stationStatus_class = 'bg-danger';\r\n        break;\r\n      case 1:\r\n        stationStatus = '正常營運';\r\n        stationStatus_class = 'bg-success';\r\n        break;\r\n      case 2:\r\n        stationStatus = '暫停營運';\r\n        stationStatus_class = 'bg-dark';\r\n        break;\r\n    }\r\n\r\n    // popUp 內容\r\n    let popUpContent = `\r\n      <p class=\"fz-5 fw-bold my-4 me-2\">${el.StationName.Zh_tw}</p>\r\n      <a class=\"rounded-pill bg-blue text-white py-2 px-3 mb-2\" href=\"https://www.google.com/maps/search/?api=1&map_action=map&zoom=16&query=(${el.StationAddress.Zh_tw})\">\r\n        使用 GoogleMap 導航\r\n      </a>\r\n      <span class=\"fz-3 badge py-2 px-2 ms-2 ${stationStatus_class}\">\r\n        ${stationStatus}\r\n      </span>\r\n      <div class=\"row d-flex\">\r\n        <div class=\"col-6 py-3 fz-3 fw-bold text-center\">\r\n          可借車輛\r\n          <p class=\"fz-10 fw-bold text-success m-0\">\r\n            ${el.AvailableRentBikes}\r\n          </p>\r\n        </div>\r\n        <div class=\"col-6 py-3 fz-3 fw-bold text-center\">\r\n          可停空位\r\n          <p class=\"fz-10 fw-bold text-warning m-0\">\r\n            ${el.AvailableReturnBikes}\r\n          </p>\r\n        </div>\r\n      </div>`;\r\n\r\n    const lat = el.StationPosition.PositionLat;\r\n    const lng = el.StationPosition.PositionLon;\r\n\r\n    // 標記站點黃色 icon & 為站點綁上 popUp 彈跳視窗\r\n    lendLayer = L.marker([lat,lng], {icon: lendIcon})\r\n    .bindPopup().setPopupContent(popUpContent);\r\n    lendLayer.addTo(bikeMap);\r\n    // lendMarkers.addLayer(lendLayer);\r\n  });\r\n  // bikeMap.addLayer(lendMarkers);\r\n}\r\n\r\n// 標記還車站點與數量（黑色）\r\nlet returnLayer = null;\r\nfunction set_returnMarkers(){\r\n  // returnMarkers = new L.MarkerClusterGroup().addTo(bikeMap);\r\n  newData.forEach(el=>{\r\n    // 站點圖示\r\n    let returnIcon = L.divIcon({\r\n      iconSize: [0,0],\r\n      iconAnchor: [22, 94],\r\n      popupAnchor: [-3, -76],\r\n      html: `\r\n      <div class=\"returnIcon\">\r\n        <img src=\"./assets/images/icons/stationMark_black.svg\"/>\r\n        <div class=\"bikeNum\">\r\n          <span class=\"text-primary\">${el.AvailableReturnBikes}</span>\r\n        </div>\r\n      </div`\r\n    });\r\n\r\n    // 站點營運狀態判斷\r\n    let stationStatus;\r\n    let stationStatus_class;\r\n    switch (el.ServiceStatus) {\r\n      // [0:'停止營運',1:'正常營運',2:'暫停營運'] \r\n      case 0:\r\n        stationStatus = '停止營運';\r\n        stationStatus_class = 'bg-danger';\r\n        break;\r\n      case 1:\r\n        stationStatus = '正常營運';\r\n        stationStatus_class = 'bg-success';\r\n        break;\r\n      case 2:\r\n        stationStatus = '暫停營運';\r\n        stationStatus_class = 'bg-dark';\r\n        break;\r\n    }\r\n\r\n    // popUp 內容\r\n    let popUpContent = `\r\n      <p class=\"fz-5 fw-bold my-4 me-2\">${el.StationName.Zh_tw}</p>\r\n      <a class=\"rounded-pill bg-blue text-white py-2 px-3 mb-2\" href=\"https://www.google.com/maps/search/?api=1&map_action=map&zoom=16&query=(${el.StationAddress.Zh_tw})\">\r\n        使用 GoogleMap 導航\r\n      </a>\r\n      <span class=\"fz-3 badge py-2 px-2 ms-2 ${stationStatus_class}\">\r\n        ${stationStatus}\r\n      </span>\r\n      <div class=\"row d-flex\">\r\n        <div class=\"col-6 py-3 fz-3 fw-bold text-center\">\r\n          可借車輛\r\n          <p class=\"fz-10 fw-bold text-success m-0\">\r\n            ${el.AvailableRentBikes}\r\n          </p>\r\n        </div>\r\n        <div class=\"col-6 py-3 fz-3 fw-bold text-center\">\r\n          可停空位\r\n          <p class=\"fz-10 fw-bold text-warning m-0\">\r\n            ${el.AvailableReturnBikes}\r\n          </p>\r\n        </div>\r\n      </div>`;\r\n    \r\n    const lat = el.StationPosition.PositionLat;\r\n    const lng = el.StationPosition.PositionLon;\r\n\r\n    // 標記站點黃色 icon & 為站點綁上 popUp 彈跳視窗\r\n    returnLayer = L.marker([lat,lng], {icon: returnIcon})\r\n    .bindPopup().setPopupContent(popUpContent);\r\n    returnLayer.addTo(bikeMap);\r\n    // returnMarkers.addLayer(returnLayer);\r\n  });\r\n  // bikeMap.addLayer(returnMarkers);\r\n}","","\r\n// 取得使用者目前所在位置、載入地圖圖資、標記當前位置\r\n// 判斷當前頁面導入適當功能\r\nfunction getCurrentPos_route(){\r\n  \r\n    // 先判斷使用者裝置是否有 navigator.geolocation 功能，並執行之\r\n    if(navigator.geolocation){\r\n        navigator.geolocation.getCurrentPosition(success, error);\r\n        // navigator.geolocation.watchPosition(success, error);\r\n      } else {\r\n        // 若出現錯誤，先自動將定位定在台北市中心\r\n        pos_lat = 25.04;\r\n        pos_lng = 121.54;\r\n        alert('您的裝置不支援地理位置功能');\r\n      }\r\n    \r\n    // fun：錯誤訊息處理\r\n    function error(error){\r\n      // 若出現錯誤，先自動將定位定在台北市中心\r\n      pos_lat = 25.04;\r\n      pos_lng = 121.54;\r\n      // 各種錯誤碼類型\r\n      switch(error.code)  {\r\n        case error.PERMISSION_DENIED:\r\n            console.log(\"User denied the request for Geolocation.\");\r\n            break;\r\n  \r\n        case error.POSITION_UNAVAILABLE:\r\n            console.log(\"Location information is unavailable.\");\r\n            break;\r\n  \r\n        case error.TIMEOUT:\r\n            console.log(\"The request to get user location timed out.\");\r\n            break;\r\n  \r\n        case error.UNKNOWN_ERROR:\r\n            console.log(\"An unknown error occurred.\");\r\n            break;\r\n      }\r\n    }\r\n  \r\n    // fun：成功執行\r\n    function success(pos){\r\n      // 獲取目前位置經緯度\r\n      pos_lat = pos.coords.latitude;\r\n      pos_lng = pos.coords.longitude;\r\n      console.log(pos.coords.latitude,pos.coords.longitude);\r\n  \r\n      // 設定地圖：以當前座標為中心點\r\n      routeMap.setView([pos_lat,pos_lng], 16);\r\n      // let routeMap = L.map('map_show', {\r\n      //     center: [pos_lat,pos_lng],\r\n      //     zoom: 16\r\n      // })\r\n  \r\n      // 載入圖磚\r\n      L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {\r\n          attribution: 'Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors, Imagery © <a href=\"https://www.mapbox.com/\">Mapbox</a>',\r\n          maxZoom: 19,\r\n          id: 'mapbox/streets-v11',\r\n          tileSize: 512,\r\n          zoomOffset: -1,\r\n          accessToken: 'pk.eyJ1Ijoic3lsdmlhaC10dyIsImEiOiJja3c2Nzl2eHUweXlmMnFtZTRjb2VjcDQxIn0.Gx5M_zr8rDs4T-jawF2UDQ'\r\n      }).addTo(routeMap);\r\n  \r\n      // 目前所在位置 GPS 圖示內容\r\n      let posGPSIcon = L.divIcon({\r\n          iconSize: [70,70],\r\n          html: `<div id=\"lottie_GPS\"></div>`\r\n      });\r\n  \r\n      // 在地圖上標記所在位置 GPS 圖示\r\n      L.marker([pos_lat,pos_lng], {icon: posGPSIcon}).addTo(routeMap);\r\n  \r\n      // 顯示所在位置 GPS 圖示 lottie 動畫\r\n      const gpsYoubike = lottie.loadAnimation({\r\n      wrapper: lottie_GPS,\r\n      animType: 'svg',\r\n      loop: true,\r\n      autoplay: false,\r\n      path: './assets/images/youbike_GPS.json'\r\n      });\r\n      gpsYoubike.play();\r\n  \r\n      // 取得附近站點資訊\r\n    //   get_nearbyStation(pos_lat,pos_lng);\r\n  \r\n    }\r\n  \r\n}\r\n\r\nlet cityRoute = [];\r\nfunction get_cityRoute(city){\r\n  const endpoint = `https://ptx.transportdata.tw/MOTC/v2/Cycling/Shape/${city}`;\r\n\r\n  axios.get(endpoint,\r\n    {\r\n      headers: getAuthorizationHeader()\r\n    })\r\n  .then(response => {\r\n    cityRoute = response.data;\r\n    console.log(cityRoute);\r\n    let str = '<option selected>選擇路線</option>';\r\n    cityRoute.forEach(el => {\r\n      str += `<option value=\"${el.RouteName}\">${el.RouteName}</option>`\r\n    })\r\n    select_route.innerHTML = str;\r\n  })\r\n  .catch(err => console.log(err));\r\n\r\n}\r\n\r\nfunction get_Route(route){\r\n\r\n    if(routeLayer) {\r\n      routeMap.removeLayer(routeLayer);\r\n    }\r\n    if(routeInfoLayer) {\r\n      routeMap.removeLayer(routeInfoLayer);\r\n    }\r\n    if(routeEndLayer) {\r\n      routeMap.removeLayer(routeEndLayer);\r\n    }\r\n    \r\n    cityRoute.forEach(item => {\r\n      if (item.RouteName === route) {\r\n        const geo = item.Geometry;\r\n        polyLine(geo,item);\r\n      }\r\n    });\r\n\r\n}\r\n\r\n\r\n// 畫出自行車的路線\r\nlet routeLayer = null;\r\n// 標記自行車路線起訖點與路線資訊\r\nlet routeInfoLayer = null;\r\nlet routeEndLayer = null;\r\n\r\nfunction polyLine(geoData,routeInfo) {\r\n  // 建立 wkt 的實體\r\n  const wicket = new Wkt.Wkt();\r\n  const geojsonFeature = wicket.read(geoData).toJson();\r\n\r\n  // 傳統繪製路線寫法\r\n  // const path = {\r\n  //   \"color\": \"#44CCFF\",\r\n  //   \"weight\": 15,\r\n  //   \"opacity\": 0.65\r\n  // };\r\n  // const routeLayer = L.geoJSON(geojsonFeature, {\r\n  //   style: path\r\n  // }).addTo(routeMap);\r\n\r\n  // routeLayer.addData(geojsonFeature);\r\n  // routeMap.fitBounds(routeLayer.getBounds());\r\n  \r\n  console.log(geojsonFeature.coordinates[0][0]); // geojsonFeature 資料是先經度再緯度，需要轉換\r\n\r\n  // 用 leaflet-ant-path 套件繪製動態路徑\r\n  const pathData = geojsonFeature.coordinates[0].map(el=>el.reverse());\r\n  const pathStyle = {\r\n    \"delay\": 800,\r\n    \"dashArray\": [\r\n      10,\r\n      25\r\n    ],\r\n    \"weight\": 8,\r\n    \"color\": \"#000000\",\r\n    \"pulseColor\": \"#EDFA03\",\r\n    \"paused\": false,\r\n    \"reverse\": false,\r\n    \"hardwareAccelerated\": true\r\n  }\r\n  routeLayer = new L.Polyline.AntPath(pathData, pathStyle);\r\n  routeLayer.addTo(routeMap);\r\n  routeMap.fitBounds(routeLayer.getBounds());\r\n\r\n  // 站點圖示\r\n  let startIcon = L.icon({\r\n    iconUrl: './assets/images/icons/routeStart.png',\r\n    iconSize: [36, 50],\r\n    iconAnchor: [25, 45],\r\n    popupAnchor: [-3, -76],\r\n  });\r\n  let endIcon = L.icon({\r\n    iconUrl: './assets/images/icons/routeEnd.png',\r\n    iconSize: [36, 50],\r\n    iconAnchor: [25, 45],\r\n    popupAnchor: [-3, -76],\r\n  });\r\n  \r\n  // popUp 內容\r\n  let popUpContent = `\r\n  <p class=\"fz-5 fw-bold my-4 me-2\">${routeInfo.RouteName}</p>\r\n  <p class=\"fz-4 text-gray\">${routeInfo.Direction?routeInfo.Direction:''} ${(parseInt(routeInfo.CyclingLength)/1000).toFixed(1)} 公里</p>\r\n  <div class=\"fz-4 fw-bold d-flex\">\r\n    路線起點：\r\n    <span class=\"fz-4 fw-normal\">\r\n      ${routeInfo.RoadSectionStart}\r\n    </span>\r\n  </div>\r\n  <div class=\"fz-4 fw-bold d-flex\">\r\n    路線迄點：\r\n    <span class=\"fz-4 fw-normal\">\r\n      ${routeInfo.RoadSectionEnd}\r\n    </span>\r\n  </div>`;\r\n    \r\n  // 標記起訖站點 & 為站點綁上 popUp 彈跳視窗\r\n  routeInfoLayer = L.marker(pathData[0], {icon: startIcon}).bindPopup().setPopupContent(popUpContent);\r\n  routeInfoLayer.addTo(routeMap).openPopup();\r\n  routeEndLayer = L.marker(pathData[pathData.length-1], {icon: endIcon});\r\n  routeEndLayer.addTo(routeMap);\r\n\r\n}\r\n","\r\n// 取得使用者目前所在位置、載入地圖圖資、標記當前位置\r\n// 判斷當前頁面導入適當功能\r\nfunction getCurrentPos_spot(){\r\n  \r\n    // 先判斷使用者裝置是否有 navigator.geolocation 功能，並執行之\r\n    if(navigator.geolocation){\r\n        navigator.geolocation.getCurrentPosition(success, error);\r\n        // navigator.geolocation.watchPosition(success, error);\r\n      } else {\r\n        // 若出現錯誤，先自動將定位定在台北市中心\r\n        pos_lat = 25.04;\r\n        pos_lng = 121.54;\r\n        alert('您的裝置不支援地理位置功能');\r\n      }\r\n    \r\n    // fun：錯誤訊息處理\r\n    function error(error){\r\n      // 若出現錯誤，先自動將定位定在台北市中心\r\n      pos_lat = 25.04;\r\n      pos_lng = 121.54;\r\n      // 各種錯誤碼類型\r\n      switch(error.code)  {\r\n        case error.PERMISSION_DENIED:\r\n            console.log(\"User denied the request for Geolocation.\");\r\n            break;\r\n  \r\n        case error.POSITION_UNAVAILABLE:\r\n            console.log(\"Location information is unavailable.\");\r\n            break;\r\n  \r\n        case error.TIMEOUT:\r\n            console.log(\"The request to get user location timed out.\");\r\n            break;\r\n  \r\n        case error.UNKNOWN_ERROR:\r\n            console.log(\"An unknown error occurred.\");\r\n            break;\r\n      }\r\n    }\r\n  \r\n    // fun：成功執行\r\n    function success(pos){\r\n      // 獲取目前位置經緯度\r\n      pos_lat = pos.coords.latitude;\r\n      pos_lng = pos.coords.longitude;\r\n      console.log(pos.coords.latitude,pos.coords.longitude);\r\n  \r\n      // 設定地圖：以當前座標為中心點\r\n      spotMap.setView([pos_lat,pos_lng], 16);\r\n      // let spotMap = L.map('map_show', {\r\n      //     center: [pos_lat,pos_lng],\r\n      //     zoom: 16\r\n      // })\r\n  \r\n      // 載入圖磚\r\n      L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {\r\n          attribution: 'Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors, Imagery © <a href=\"https://www.mapbox.com/\">Mapbox</a>',\r\n          maxZoom: 19,\r\n          id: 'mapbox/streets-v11',\r\n          tileSize: 512,\r\n          zoomOffset: -1,\r\n          accessToken: 'pk.eyJ1Ijoic3lsdmlhaC10dyIsImEiOiJja3c2Nzl2eHUweXlmMnFtZTRjb2VjcDQxIn0.Gx5M_zr8rDs4T-jawF2UDQ'\r\n      }).addTo(spotMap);\r\n  \r\n      // 目前所在位置 GPS 圖示內容\r\n      let posGPSIcon = L.divIcon({\r\n          iconSize: [70,70],\r\n          html: `<div id=\"lottie_GPS\"></div>`\r\n      });\r\n  \r\n      // 在地圖上標記所在位置 GPS 圖示\r\n      L.marker([pos_lat,pos_lng], {icon: posGPSIcon}).addTo(spotMap);\r\n  \r\n      // 顯示所在位置 GPS 圖示 lottie 動畫\r\n      const gpsYoubike = lottie.loadAnimation({\r\n      wrapper: lottie_GPS,\r\n      animType: 'svg',\r\n      loop: true,\r\n      autoplay: false,\r\n      path: './assets/images/youbike_GPS.json'\r\n      });\r\n      gpsYoubike.play();\r\n  \r\n      // 取得附近站點資訊\r\n    //   get_nearbyStation(pos_lat,pos_lng);\r\n  \r\n    }\r\n  \r\n}\r\n  ","// header 驗證\r\nfunction getAuthorizationHeader() {\r\n    let AppID = '9eeb30e3588740618367a446631cbc3f';\r\n    let AppKey = 'CKTwBadJd3_0_EdqiXE0kEg8fTw';\r\n    let GMTString = new Date().toGMTString();\r\n    let ShaObj = new jsSHA('SHA-1', 'TEXT');\r\n    ShaObj.setHMACKey(AppKey, 'TEXT');\r\n    ShaObj.update('x-date: ' + GMTString);\r\n    let HMAC = ShaObj.getHMAC('B64');\r\n    let Authorization = 'hmac username=\\\"' + AppID + '\\\", algorithm=\\\"hmac-sha1\\\", headers=\\\"x-date\\\", signature=\\\"' + HMAC + '\\\"';\r\n    return { 'Authorization': Authorization, 'X-Date': GMTString }; \r\n}\r\n"]}